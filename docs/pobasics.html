<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PyPO User Manual: Introduction To Physical Optics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PyPO User Manual
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('pobasics.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Introduction To Physical Optics</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="pobasics_intro"></a>
Introduction</h1>
<p>The Physical Optics method is a high frequency technique for calculating the \(\mathbf{E}\) and \(\mathbf{H}\) fields scattered by objects.</p>
<p>The general scattering problem consists of a known incident field incident on a scatterer of some known geometry and material properties. The output is the total radiated fields, which can be divided into the incident fields \(\mathbf{E}_{inc}\) and \(\mathbf{H}_{inc}\) and the scattered fields \(\mathbf{E}_{scat}\) and \(\mathbf{H}_{scat}\).</p>
<p>$$ \mathbf{E} = \mathbf{E}_{inc} + \mathbf{E}_{scat} $$ $$ \mathbf{H} = \mathbf{H}_{inc} + \mathbf{H}_{scat} $$</p>
<p>For a thin scattering surface, the scattered fields can be further divided into reflected and transmitted fields:</p>
<p>$$ \mathbf{E}_{scat} = \mathbf{E}_{ref} + \mathbf{E}_{trans} $$ $$ \mathbf{H}_{scat} = \mathbf{H}_{ref} + \mathbf{H}_{trans} $$</p>
<p>The scattered fields can be taken as entirely due to electric and magnetic currents, \(\mathbf{J}\) and \(\mathbf{M}\), induced on the surface(s) of the scatterer by the incident fields.</p>
<h1><a class="anchor" id="pobasics_approx"></a>
The Physical Optics Approximation</h1>
<p>The Physical Optics approximation consists of assuming that the surface electric and magnetic currents at a specific point on a curved scatterer are the same as those on an infinite plane tangent to scattering surface at that point. Each of the incident, reflected and transmitted fields contribute to the surface currents.</p>
<p>On a perfectly electrially conducting (PEC) plane surface, the transmitted fields vanish. The reflected \(\mathbf{E}_{ref}\) field at the scattering surface is equal to the incident field, but with opposite phase, while the reflected \(\mathbf{H}_{ref}\) field has the same phase as the incident field.</p>
<p>Thus for a perfectly conducting scatterering plane, these currents are given by:</p>
<p>$$ \mathbf{J} = \mathbf{\hat{n}} \times (\mathbf{H}_{inc} + \mathbf{H}_{ref}) = 2 \mathbf{\hat{n}} \times \mathbf{H}_{inc} $$ $$ \mathbf{M} = - \mathbf{\hat{n}} \times (\mathbf{E}_{inc} + \mathbf{E}_{ref}) = 0 $$</p>
<p>The currents across the surface of a curved scatterer are thus calculated by dividing the scatterer in the planar facets, and calculating the currents on each facet as if it were an infinite plane.</p>
<p>These currents are only present in the region of the scatterer directly illuminated by the source of the incident radiation field. An additional approximation within the Physical Optics method for PEC scatterers is that the currents on portions of the scatterer that are shadowed from the source (under geometric ray optics) are exactly zero.</p>
<h1><a class="anchor" id="pobasics_fieldnorm"></a>
Field normalization</h1>
<p>The electric and magnetic fields and currents in PyPO are rms values measured in normalized units:</p>
<p>$$\mathbf{E} = \frac{1}{k\sqrt{2Z}} \mathbf{E}_{SI} $$ $$\mathbf{H} = \frac{\sqrt{Z}}{k\sqrt{2}} \mathbf{H}_{SI} $$ $$\mathbf{J} = \frac{\sqrt{Z}}{k\sqrt{2}} \mathbf{J}_{SI} $$ $$\mathbf{E} = \frac{1}{k\sqrt{2Z}} \mathbf{E}_{SI} $$</p>
<p>where:</p>
<p>\(k = \frac{2 \pi c}{n \lambda} = \omega\sqrt{\epsilon\mu}\) is the wave number.</p>
<p>\(Z = \sqrt{\frac{\mu_r \mu_0}{\epsilon_r \epsilon_0}}\) is the impedance of the background media</p>
<p>This choice eliminates the physical constants \(\epsilon_0\) and \(\mu_0\) from the electromagnetic equations, and keeps the field values closer to unity, which aids in numerical accuracy of the computations.</p>
<p>The time factor \(e^{i\omega t}\) is suppressed throughout.</p>
<h1><a class="anchor" id="pobasics_fieldcalc"></a>
Calculation of fields at a point</h1>
<p>Once the electric and magnetic currents induced at each point across the scatterer have been calculated, it is then necessary to calculated the field due to those currents at some distant point \(\mathbf{r}\). This is carried out using source representation of the field that is a solution to the Helmholtz equation for monochromatic fields in isotropic media due to a source Hertzian dipole, and integrating over the current distribution induced on the scatterer surface.</p>
<p>For the electric component of the field, this is given by:</p>
<p>$$ \mathbf{E}(\mathbf{r}) = - k Z_m \int_{S} \Big( 1 + \frac{1}{k^2}\mathbf{\nabla}\mathbf{\nabla} \Big) G(\mathbf{r}, \mathbf{r_q}) \cdot \mathbf{J}(\mathbf{r_s}) d s_q + \int_{S} \mathbf{M}(\mathbf{r_q}) \times \mathbf{\nabla} G(\mathbf{r}, \mathbf{r_q}) d s_q $$</p>
<p>$$ \mathbf{H}(\mathbf{r}) = - k Z_m \int_{S} \Big( 1 + \frac{1}{k^2}\mathbf{\nabla}\mathbf{\nabla} \Big) G(\mathbf{r}, \mathbf{r_q}) \cdot \mathbf{M}(\mathbf{r_s}) d s_q + \int_{S} \mathbf{J}(\mathbf{r_q}) \times \mathbf{\nabla} G(\mathbf{r}, \mathbf{r_q}) d s_q $$</p>
<p>where:</p>
<p>\(\mathbf{r}_q\) is a point on the source scatterer.</p>
<p>\(S\) is the source scatterer to be integrated over.</p>
<p>\(d s_q\) is an area element of the source scatterer surface centered at \(\mathbf{r}_q\)</p>
<p>\(G = \frac{e^{-i k R}}{4 \pi R}\) is the freespace Green's function</p>
<p>\(R = |\mathbf{r_q} - \mathbf{r}|\) is the distance between the observation point and the point on the source scatterer.</p>
<p>Applying these two equations to propagation in a linear lossless medium yields:</p>
<p>$$ \mathbf{E}(\mathbf{r}) = \int_{S} \frac{k^2}{4\pi} e^{-ikR} \Bigg[ Z_m \Bigg[ \mathbf{J} (\mathbf{r_s}) \Bigg(\frac{-i}{k R} - \frac{1}{k^2 R^2} + \frac{i}{k^3 R^3} \Bigg) + \Big(\mathbf{J} (\mathbf{r_s})\cdot\mathbf{\hat{R}}\Big) \mathbf{\hat{R}} \Bigg( \frac{i}{kR} + \frac{3}{k^2 R^2} - \frac{3 i}{k^3 R^3} \Bigg) \Bigg] - \mathbf{M}(\mathbf{r}) \times \mathbf{\hat{R}} \Bigg( \frac{1}{k^2 R^2} + \frac{i}{kR}\Bigg) \Bigg] ds $$</p>
<p>$$ \mathbf{H}(\mathbf{r}) = \int_{S} \frac{k^2}{4\pi} e^{-ikR} \Bigg[ \frac{1}{Z_m} \Bigg[ \mathbf{M} (\mathbf{r_s}) \Bigg(\frac{-i}{k R} - \frac{1}{k^2 R^2} + \frac{i}{k^3 R^3} \Bigg) + \Big(\mathbf{M} (\mathbf{r_s})\cdot\mathbf{\hat{R}}\Big) \mathbf{\hat{R}} \Bigg( \frac{i}{kR} + \frac{3}{k^2 R^2} - \frac{3 i}{k^3 R^3} \Bigg) \Bigg] + \mathbf{J}(\mathbf{r}) \times \mathbf{\hat{R}} \Bigg( \frac{1}{k^2 R^2} + \frac{i}{kR}\Bigg) \Bigg] ds $$</p>
<h2><a class="anchor" id="pobasics_farfields"></a>
Farfields</h2>
<p>In the far field limit \(R\rightarrow\infty\), the above expressions reduce to:</p>
<p>$$\mathbf{E}(\mathbf{\hat{r}}) = \int_S \frac{-i k^2}{4\pi} e^{ik\mathbf{r}_s\cdot\mathbf{\hat{r}}} \Big[ Z_m\big(\mathbf{J} - (\mathbf{J}\cdot\mathbf{\hat{r}})\big) - \mathbf{\hat{r}}\times \mathbf{M}\Big] ds $$</p>
<p>$$\mathbf{H}(\mathbf{\hat{r}}) = \int_S \frac{-i k^2}{4\pi} e^{ik\mathbf{r}_s\cdot\mathbf{\hat{r}}} \Big[ \frac{1}{Z_m}\big(\mathbf{M} - (\mathbf{M}\cdot\mathbf{\hat{r}})\big) + \mathbf{\hat{r}}\times \mathbf{J}\Big] ds $$</p>
<p>where \(\mathbf{\hat{r}}\) is the farfield direction vector.</p>
<h1><a class="anchor" id="pobasics_process"></a>
PO Process</h1>
<p>Physical optics simulations of a system of scatterings proceeds by:</p><ol type="1">
<li>A source of electrical and magnetic currents is definedÂ¸ either directly, or from a specified \(\mathbf{E}\) and \(\mathbf{H}\) field using a specified boundary condition (PEC is the default choice).</li>
<li>The fields and currents on the first scatterer due to the source are calculated. First \(\mathbf{E}_{inc}\) and \(\mathbf{H}_{inc}\) fields due to the source are calculated at each grid point on the target scatterer. From these fields, the electric and magnetic currents, \(\mathbf{J}\) and \(\mathbf{M}\), induced on the scatterer are determined.</li>
<li>The fields and currents on the second scatterer due to the currents on the first scatterer are calculated. This process is repeated for each scatterer in the system.</li>
<li>The output fields are calculated from the currents induced on the final scatterer.</li>
</ol>
<p>In general, the fields on each scattering and output plane can be calculated due to multiple sources by simply adding the fields from each individual source.</p>
<h1><a class="anchor" id="pobasics_integration"></a>
The Surface Integral</h1>
<p>Evaluation of the surface integral in the calculation of the incident field on a scatterer is the main computational challenge in performing PO calculations.</p>
<p>For moderately large surfaces and non-paraxial angles between the source surface normal and the target point, the complex phase of the integrands oscilates rapidly due to both the Green's function's \(e^{-i k R}\) term, and to phase wraps in the source current distribution.</p>
<p>The integral is performed using the trapezoidal method first over the \(y\) or \(\phi\) directions, followed by the \(x\) or \(\rho\) directions. For a closed integration range in the \(\phi\), the first point is also used in the calculation of the final trapezoidal element.</p>
<p>Performing the integration in this order allows for the future use of lower numbers of PO points near the center of a polar grid, where the \(\phi\) grid is oversampled.</p>
<p>Each evaluation of the integrands at a specific source point needs to know the value of the current element at that point. <br  />
 Using a fully automatic integration routine like those in scipy.integrate to perform the integration would require that the field at each point on the source scatterer be evaluated by performing a similar integral over the source that is illuminating that scatterer. <br  />
 This would require that the whole PO chain be calculated at once.</p>
<p>We can avoid this problem by dividing the integration routine into several steps:</p><ol type="1">
<li>First designate the integration points on the source scatterer. This is equivalent to manually setting the number of points to be used.</li>
<li>Calculate the current elements at those points.</li>
<li>Calculate the fields at the target point(s).</li>
</ol>
<p>This sequence can be repeated for each scatterer in the optics chain.</p>
<h2><a class="anchor" id="pobasics_convergence"></a>
Convergence of the integrals</h2>
<p>The surface integrals converge fastest for focused reflectors at points close to the main lobe of the radiation pattern - in this region, the integrand only oscillates slowly in phase as the position across the source is varied. As the observation point moves away from the main lobe into the far sidelobe regions, the phase of the integrand varies more rapidly, and a finer grid of points is required to adequately sample the integrands.</p>
<p>In general for the integral to converge, at least one sample per period of oscillation is required - the cycle of oscillation includes both the distance from source to the scattering, and from the scattering to the target point. Thus we require a point spacing on the scatterer of \( \Delta r + \Delta r&#39; \lt \lambda / 2 \). For the worst case of illumination of a scatterer at an angle nearly parallel to the surface, and an observation point nearly anti-parallel to the incoming ray, this means that integration points on the scatterer must be spaced \( \lambda / 2 \) apart. This gives an upper limit on the number of points required.</p>
<p>For a reflector with a circular rim, the spacing between integration points on the rim is</p>
<p>$$ \Delta r = \pi \frac{D}{n_\phi} $$</p>
<p>Thus the integral will converge if</p>
<p>$$ n_\phi \gt 2\pi \frac{D}{\lambda} $$</p>
<p>For a focused reflector with a circular rim of diameter \(D\) observed at an angle \( \theta \) to the main beam, the integral will converge if:</p>
<p>$$ n_\rho \gt 2.4\Bigg(1.09\cdot\pi\frac{D}{\lambda}\sin\theta + 10 \Bigg) $$</p>
<p>and</p>
<p>$$ n_\phi \gt 1.09\cdot\pi\frac{D}{\lambda}\sin\theta + 10 $$</p>
<p>For a focused reflector with a rectangular rim, the integral will converge for</p>
<p>$$ n_{x,y} = 1.75\cdot \frac{D_{x,y}}{\lambda}\sin \theta_{x,y} +10 $$</p>
<p>Again, the worst case is that a point spacing of</p>
<p>$$ n_{x, y} = 3.5 \frac{D_{x,y}}{\lambda} $$</p>
<h1><a class="anchor" id="pobasics_materialproperties"></a>
Material Properties</h1>
<p>For a scatterer other than a perfect electrical conductor, the reflected \(\mathbf{H}_{ref}\) field at the surface is no longer equal to the incident \(\mathbf{H}_{inc}\) field, and the reflected \(\mathbf{E}_{ref}\) field no longer exactly cancels the incident \(\mathbf{E}_{inc}\) field. The transmitted fields are also no longer generally zero.</p>
<p>The reflection and transmission coefficients in general vary with angle, and also differ for incident plane waves that are polarized perpendicular and parallel to the plane defined by the incident and reflected rays.</p>
<h1><a class="anchor" id="pobasics_limitations"></a>
Limitations of the PO approximation</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
